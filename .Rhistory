aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE))
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous"))
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous"))
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(Year) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup()
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup()
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
reshape2::dcast(pollution_level ~ city, value.var = "per") %>%
rename(Label = pollution_level) %>%
chartJSRadar(maxScale = 90, showToolTipLabel=TRUE)
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) + geom_bar(stat="identity")
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) + geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels For Different Cities in 2016") + labs(x = "City" , y = "Percentage(%)")
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) + geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") + labs(x = "City" , y = "Percentage(%)")
library(plotly)
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) + geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") + labs(x = "City" , y = "Percentage(%)") + ggplotly()
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) + geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") + labs(x = "City" , y = "Percentage(%)") %>%  ggplotly()
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) + geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage(%)") %>%  ggplotly()
p <- aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) + geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage(%)")
ggplotly(p)
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) + geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage(%)")
ggplotly()
?ggplotly
p <- aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = factor(city), y = per, fill = factor(pollution_level))) +
geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage(%)")
ggplotly(p)
ggplotly()
p <- aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = factor(pollution_level))) +
geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage(%)")
ggplotly()
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = factor(pollution_level))) +
geom_bar(stat="identity") +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage(%)")
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, y = per, fill = pollution_level)) +
geom_bar(stat="identity") + scale_y_continuous(labels = percent_format()) +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage")
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, fill = pollution_level)) +
geom_bar(stat="identity", aes(y = per)) + scale_y_continuous(labels = percent_format()) +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage")
aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, fill = pollution_level)) +
geom_bar(stat="identity", position="fill", aes(y = per)) + scale_y_continuous(labels = percent_format()) +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage")
p <- aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, fill = pollution_level)) +
geom_bar(stat="identity", position="fill", aes(y = per)) +
scale_y_continuous(labels = percent_format()) +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage")
ggplotly(p)
p <- aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, fill = factor(pollution_level))) +
geom_bar(stat="identity", position="fill", aes(y = per)) +
scale_y_continuous(labels = percent_format()) +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage")
ggplotly(p)
p <- aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = factor(city), fill = factor(pollution_level))) +
geom_bar(stat="identity", position="fill", aes(y = per)) +
scale_y_continuous(labels = percent_format()) +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage")
p
p<- aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = factor(city), fill = factor(pollution_level))) +
geom_bar(stat="identity", position="fill", aes(y = per)) +
scale_y_continuous(labels = percent_format()) +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage")
p
ggplotly(p)
DF <- read.table(text="Rank F1     F2     F3
1    500    250    50
2    400    100    30
3    300    155    100
4    200    90     10", header=TRUE)
library(reshape2)
DF1 <- melt(DF, id.var="Rank")
p <- ggplot(DF1, aes(x = Rank, y = value, fill = variable)) +
geom_bar(stat = "identity")
ggplotly(p)
DF <- read.table(text="Rank F1     F2     F3
1    500    250    50
2    400    100    30
3    300    155    100
4    200    90     10", header=TRUE)
DF1 <- melt(DF, id.var="Rank")
p <- ggplot(DF1, aes(x = Rank, y = value, fill = variable)) +
geom_bar(stat = "identity")
ggplotly(p)
ggplotly(p)
ggplotly(p)
p<- aq_df %>% select(city, Day, value) %>%
filter(between(Day, as.Date('2016-01-01'), as.Date('2016-12-31'))) %>%
group_by(Day, city) %>% summarise(avgvalue = mean(value, tr = 0.1, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pollution_level = case_when(
findInterval(.$avgvalue, c(0, 51)) == 1 ~ "Good",
findInterval(.$avgvalue, c(51, 101)) == 1 ~ "Moderate",
findInterval(.$avgvalue, c(101, 150)) == 1 ~ "Unhealthy(SensitiveGroups)",
findInterval(.$avgvalue, c(151, 201)) == 1 ~ "Unhealthy",
findInterval(.$avgvalue, c(201, 300)) == 1 ~ "VeryUnhealthy",
.$avgvalue > 300 ~ "Hazardous")) %>%
group_by(pollution_level, city) %>%
summarise(num_days = n()) %>%
group_by(city) %>%
mutate(per = round(num_days/sum(num_days)*100, 2)) %>%
ungroup() %>%
select(pollution_level, city, per) %>%
ggplot(aes(x = city, fill = factor(pollution_level))) +
geom_bar(stat="identity", position="fill", aes(y = per)) +
scale_y_continuous(labels = percent_format()) +
ggtitle("Percentage of Days at different Air Pollution levels in 2016") +
labs(x = "City" , y = "Percentage")
ggplotly(p)
ggplotly(p)
p
10/365
30/365
30*12
library(blogdown)
serve_site()
serve_site()
serve_site()
serve_site()
library(blogdown)
serve_site()
